---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  return articles.map(article => ({
    params: { slug: article.slug },
    props: { article },
  }));
}

const { article } = Astro.props;
const { Content } = await article.render();
---

<BaseLayout
  title={article.data.title}
  description={article.data.description}
  keywords={article.data.keywords.join(', ')}
>
  <main class="pt-32 pb-16 px-4">
    <article class="max-w-4xl mx-auto">
      <!-- Hero Section -->
      <div class="mb-12 text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4 text-gradient">
          {article.data.hero.title}
        </h1>
        <p class="text-xl text-gray-600 mb-6">
          {article.data.hero.subtitle}
        </p>
        <a
          href={`${import.meta.env.BASE_URL}#contact`}
          class="inline-block bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-700 transition-all duration-300 shadow-lg hover:shadow-xl"
        >
          {article.data.hero.cta_text}
        </a>
      </div>

      <!-- Case Studies (if available) -->
      {article.data.case_studies && article.data.case_studies.length > 0 && (
        <div class="mb-16 bg-gradient-to-br from-purple-50 via-pink-50 to-purple-50 p-8 rounded-2xl shadow-xl border border-purple-100 relative overflow-hidden">
          <!-- Decorative stars -->
          <div class="absolute top-4 right-4 text-yellow-400 text-2xl animate-pulse">⭐</div>
          <div class="absolute top-12 right-12 text-yellow-300 text-lg animate-pulse" style="animation-delay: 0.3s;">✨</div>
          <div class="absolute bottom-8 left-8 text-yellow-400 text-xl animate-pulse" style="animation-delay: 0.6s;">⭐</div>

          <div class="text-center mb-8 relative z-10">
            <span class="inline-block px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white text-sm font-bold rounded-full uppercase mb-3">
              ⭐ Rezultate Dovedite ⭐
            </span>
            <h2 class="text-3xl font-bold text-gray-900">Cazuri de Succes Reale</h2>
            <p class="text-gray-600 mt-2">Rezultate masurabile pentru afaceri locale din {article.data.city}</p>
          </div>
          <div class="grid md:grid-cols-3 gap-6">
            {article.data.case_studies.map((study, index) => (
              <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 border-t-4 border-purple-600">
                <div class="flex items-center justify-between mb-4">
                  <span class="text-4xl font-bold text-purple-200">{(index + 1).toString().padStart(2, '0')}</span>
                  <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center">
                    <i class="fas fa-chart-line text-white text-lg"></i>
                  </div>
                </div>
                <h3 class="font-bold text-xl mb-2 text-gray-900">{study.business}</h3>
                <p class="text-sm text-gray-500 mb-4 flex items-center gap-2">
                  <i class="fas fa-tag text-purple-500"></i>
                  {study.niche}
                </p>
                <div class="pt-4 border-t border-purple-100">
                  <p class="text-purple-600 font-bold text-lg flex items-center gap-2">
                    <i class="fas fa-rocket text-pink-500"></i>
                    {study.result}
                  </p>
                </div>
              </div>
            ))}
          </div>
        </div>
      )}

      <!-- Article Content -->
      <div class="prose prose-lg max-w-none">
        <Content />
      </div>

      <!-- CTA Footer -->
      <div class="mt-12 text-center bg-gradient-to-r from-purple-600 to-pink-600 text-white p-8 rounded-lg">
        <h2 class="text-3xl font-bold mb-4">Pregatit Sa Incepi?</h2>
        <p class="text-xl mb-6">Contacteaza-ne astazi pentru o consultatie gratuita</p>
        <a
          href={`${import.meta.env.BASE_URL}#contact`}
          class="inline-block bg-white text-purple-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-all duration-300 shadow-lg hover:shadow-xl"
        >
          {article.data.hero.cta_text}
        </a>
      </div>
    </article>
  </main>
</BaseLayout>

<style is:global>
  .prose {
    color: #374151;
    font-size: 1.125rem;
    line-height: 1.8;
  }

  /* Main heading in content (H1) */
  .prose h1 {
    color: #1f2937;
    font-weight: 800;
    font-size: 2.5rem;
    margin-top: 3rem;
    margin-bottom: 1.5rem;
    line-height: 1.2;
  }

  /* Section headings (H2) */
  .prose h2 {
    color: #1f2937;
    font-weight: 700;
    font-size: 2rem;
    margin-top: 3rem;
    margin-bottom: 1.25rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #e5e7eb;
    line-height: 1.3;
  }

  /* Subsection headings (H3) */
  .prose h3 {
    color: #374151;
    font-weight: 600;
    font-size: 1.5rem;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
    line-height: 1.4;
  }

  /* Minor headings (H4) */
  .prose h4 {
    color: #4b5563;
    font-weight: 600;
    font-size: 1.25rem;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
    line-height: 1.4;
  }

  /* Small headings (H5, H6) */
  .prose h5 {
    color: #6b7280;
    font-weight: 600;
    font-size: 1.125rem;
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
    line-height: 1.5;
  }

  .prose h6 {
    color: #6b7280;
    font-weight: 600;
    font-size: 1rem;
    margin-top: 1.5rem;
    margin-bottom: 0.5rem;
    line-height: 1.5;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  /* Paragraphs with proper spacing */
  .prose p {
    margin-bottom: 1.5rem;
    line-height: 1.8;
  }

  /* First paragraph after heading */
  .prose h2 + p,
  .prose h3 + p,
  .prose h4 + p {
    margin-top: 0.5rem;
  }

  /* Strong emphasis */
  .prose strong {
    color: #1f2937;
    font-weight: 700;
  }

  /* Lists with better spacing and styling */
  .prose ul, .prose ol {
    margin-top: 1.5rem;
    margin-bottom: 2rem;
    padding-left: 0;
    list-style: none;
  }

  .prose ul li {
    margin-bottom: 1rem;
    padding-left: 2.5rem;
    position: relative;
    line-height: 1.75;
    background: linear-gradient(to right, #faf5ff, transparent);
    padding: 0.75rem 1rem 0.75rem 2.5rem;
    border-radius: 0.5rem;
    transition: all 0.3s ease;
  }

  .prose ul li:hover {
    background: linear-gradient(to right, #f3e8ff, transparent);
    transform: translateX(4px);
  }

  .prose ul li::before {
    content: '✓';
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    width: 1.25rem;
    height: 1.25rem;
    background: linear-gradient(135deg, #9333ea, #db2777);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: bold;
    box-shadow: 0 2px 4px rgba(147, 51, 234, 0.3);
  }

  .prose ol li {
    margin-bottom: 1rem;
    padding-left: 2.5rem;
    position: relative;
    line-height: 1.75;
    counter-increment: list-counter;
    background: linear-gradient(to right, #fef3c7, transparent);
    padding: 0.75rem 1rem 0.75rem 2.5rem;
    border-radius: 0.5rem;
    transition: all 0.3s ease;
  }

  .prose ol {
    counter-reset: list-counter;
  }

  .prose ol li:hover {
    background: linear-gradient(to right, #fde68a, transparent);
    transform: translateX(4px);
  }

  .prose ol li::before {
    content: counter(list-counter);
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    width: 1.25rem;
    height: 1.25rem;
    background: linear-gradient(135deg, #f59e0b, #ef4444);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: bold;
    box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
  }

  .prose li > p {
    margin-bottom: 0.5rem;
  }

  /* Nested lists */
  .prose ul ul,
  .prose ol ul,
  .prose ul ol,
  .prose ol ol {
    margin-top: 0.75rem;
    margin-bottom: 0.75rem;
  }

  .prose ul ul li,
  .prose ol ul li {
    background: none;
    padding: 0.5rem 0 0.5rem 2rem;
  }

  .prose ul ul li::before {
    content: '→';
    background: #9333ea;
    font-size: 0.65rem;
    width: 1rem;
    height: 1rem;
    left: 0.5rem;
  }

  .prose ol ol li,
  .prose ul ol li {
    background: none;
    padding: 0.5rem 0 0.5rem 2rem;
  }

  .prose ol ol li::before {
    width: 1rem;
    height: 1rem;
    font-size: 0.65rem;
    left: 0.5rem;
  }

  /* Links */
  .prose a {
    color: #9333ea;
    text-decoration: underline;
    transition: color 0.2s;
  }

  .prose a:hover {
    color: #db2777;
  }

  /* Blockquotes */
  .prose blockquote {
    border-left: 4px solid #9333ea;
    padding-left: 1.5rem;
    margin: 2rem 0;
    font-style: italic;
    color: #4b5563;
  }

  /* Code blocks */
  .prose code {
    background: #f3f4f6;
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-size: 0.875em;
    color: #db2777;
  }

  .prose pre {
    background: #1f2937;
    color: #f9fafb;
    padding: 1.5rem;
    border-radius: 0.5rem;
    overflow-x: auto;
    margin: 2rem 0;
  }

  .prose pre code {
    background: transparent;
    padding: 0;
    color: inherit;
  }

  /* Horizontal rules */
  .prose hr {
    border: 0;
    border-top: 2px solid #e5e7eb;
    margin: 3rem 0;
  }

  /* Tables */
  .prose table {
    width: 100%;
    margin: 2rem 0;
    border-collapse: collapse;
  }

  .prose th {
    background: #f3f4f6;
    font-weight: 600;
    padding: 0.75rem;
    text-align: left;
    border-bottom: 2px solid #e5e7eb;
  }

  .prose td {
    padding: 0.75rem;
    border-bottom: 1px solid #e5e7eb;
  }

  /* Mobile responsiveness */
  @media (max-width: 768px) {
    .prose h1 { font-size: 2rem; }
    .prose h2 { font-size: 1.75rem; }
    .prose h3 { font-size: 1.375rem; }
    .prose h4 { font-size: 1.125rem; }
    .prose { font-size: 1rem; }
  }

  /* Fancy FAQ styling - looks for specific heading patterns */
  .prose h2:has(+ h3:first-of-type) {
    background: linear-gradient(135deg, #9333ea 0%, #db2777 100%);
    color: white;
    padding: 1.5rem 2rem;
    border-radius: 1rem;
    border: none;
    margin-top: 4rem;
    margin-bottom: 2rem;
    box-shadow: 0 10px 30px rgba(147, 51, 234, 0.3);
  }

  /* FAQ Questions (H3 after specific H2) */
  .prose h3 strong,
  .prose h4 strong {
    display: block;
    background: linear-gradient(to right, #f3f4f6, #ffffff);
    padding: 1.25rem 1.5rem;
    border-left: 4px solid #9333ea;
    border-radius: 0.5rem;
    margin-bottom: 0.75rem;
    color: #1f2937;
    font-size: 1.25rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    cursor: pointer;
  }

  .prose h3 strong:hover,
  .prose h4 strong:hover {
    background: linear-gradient(to right, #ede9fe, #fce7f3);
    border-left-color: #db2777;
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(147, 51, 234, 0.15);
  }

  .prose h3 strong::before,
  .prose h4 strong::before {
    content: '❓';
    margin-right: 0.75rem;
    font-size: 1.25em;
  }

  /* FAQ Answers */
  .prose h3 + p,
  .prose h4 + p {
    background: white;
    padding: 1.25rem 1.5rem 1.25rem 3rem;
    border-left: 2px solid #e5e7eb;
    border-radius: 0 0 0.5rem 0.5rem;
    margin-top: -0.5rem;
    margin-bottom: 2rem;
    position: relative;
  }

  .prose h3 + p::before,
  .prose h4 + p::before {
    content: '💡';
    position: absolute;
    left: 1rem;
    font-size: 1.25em;
  }

  /* Special styling for "Intrebari Frecvente" or "FAQ" sections */
  .prose h2:contains("Intrebari"),
  .prose h2:contains("FAQ"),
  .prose h2[id*="faq"],
  .prose h2[id*="intrebari"] {
    background: linear-gradient(135deg, #9333ea 0%, #db2777 100%);
    color: white;
    padding: 1.5rem 2rem;
    border-radius: 1rem;
    border: none;
    margin-top: 4rem;
    margin-bottom: 2rem;
    text-align: center;
    box-shadow: 0 10px 30px rgba(147, 51, 234, 0.3);
    position: relative;
  }

  .prose h2[id*="faq"]::before,
  .prose h2[id*="intrebari"]::before {
    content: '✨';
    margin-right: 0.5rem;
    font-size: 1.2em;
  }

  .prose h2[id*="faq"]::after,
  .prose h2[id*="intrebari"]::after {
    content: '✨';
    margin-left: 0.5rem;
    font-size: 1.2em;
  }

  /* Success/Result keywords get star treatment */
  .prose strong:contains("+"),
  .prose strong:contains("%"),
  .prose strong:contains("rezultat"),
  .prose strong:contains("success") {
    position: relative;
  }

  /* Add subtle animation to elements */
  @keyframes sparkle {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
</style>
